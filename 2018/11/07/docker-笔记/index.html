<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>docker 笔记 | 刘洋的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">docker 笔记</h1><a id="logo" href="/.">刘洋的博客</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">docker 笔记</h1><div class="post-meta">Nov 7, 2018<span> | </span><span class="category"><a href="/categories/study/">study</a><a href="/categories/study/docker/">docker</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker安装"><span class="toc-number">1.</span> <span class="toc-text">docker安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于dockerfile使用docker-build-创建images"><span class="toc-number">2.</span> <span class="toc-text">基于dockerfile使用docker build 创建images</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于image运行docker容器同时运行指定主机端口"><span class="toc-number">3.</span> <span class="toc-text">基于image运行docker容器同时运行指定主机端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于image运行docker容器同时运行指定主机端口且挂载外部目录，且出错重启"><span class="toc-number">4.</span> <span class="toc-text">基于image运行docker容器同时运行指定主机端口且挂载外部目录，且出错重启</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进入到容器内部可以修改相关配置-不使用attach，attach方式因为退出，导致整个容器退出"><span class="toc-number">5.</span> <span class="toc-text">进入到容器内部可以修改相关配置,不使用attach，attach方式因为退出，导致整个容器退出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除镜像-删除容器是rm"><span class="toc-number">6.</span> <span class="toc-text">删除镜像.删除容器是rm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#把打包的镜像上传到仓库"><span class="toc-number">7.</span> <span class="toc-text">把打包的镜像上传到仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务的启动命令"><span class="toc-number">8.</span> <span class="toc-text">服务的启动命令</span></a></li></ol></div></div><div class="post-content"><h3 id="docker安装"><a href="#docker安装" class="headerlink" title="docker安装"></a>docker安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>查看安装的版本</span><br><span class="line">docker version [-f &#123;&#123;.Server.Version&#125;&#125;]</span><br><span class="line">docker info</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> step 1: 安装必要的一些系统工具</span><br><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="meta">#</span> Step 2: 添加软件源信息</span><br><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span> Step 3: 更新并安装 Docker-CE</span><br><span class="line">sudo yum makecache fast</span><br><span class="line">sudo yum -y install docker-ce</span><br><span class="line"><span class="meta">#</span> Step 4: 开启Docker服务</span><br><span class="line">sudo service docker start</span><br></pre></td></tr></table></figure>
<h3 id="基于dockerfile使用docker-build-创建images"><a href="#基于dockerfile使用docker-build-创建images" class="headerlink" title="基于dockerfile使用docker build 创建images"></a>基于dockerfile使用docker build 创建images</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>格式  </span><br><span class="line">docker build . -t 需要打包成的镜像名称  </span><br><span class="line"><span class="meta">#</span>备注：.代表dockerfile在当前目录,以dockerfile为准  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>示例  </span><br><span class="line">docker build . -t liimages/spider1.0</span><br></pre></td></tr></table></figure>
<h3 id="基于image运行docker容器同时运行指定主机端口"><a href="#基于image运行docker容器同时运行指定主机端口" class="headerlink" title="基于image运行docker容器同时运行指定主机端口"></a>基于image运行docker容器同时运行指定主机端口</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>格式  </span><br><span class="line">docker run -d -p 主机端口:容器端口 镜像名称或者Id  </span><br><span class="line"><span class="meta">#</span>备注：-d:后台运行,-p 暴露端口  </span><br><span class="line"><span class="meta">#</span>4000:80的意思是容器的80的端口映射到主机的4000端口 外部以400端口访问</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>示例  </span><br><span class="line">docker run -d -p 4000:80 liimages/spider1.0</span><br></pre></td></tr></table></figure>
<h3 id="基于image运行docker容器同时运行指定主机端口且挂载外部目录，且出错重启"><a href="#基于image运行docker容器同时运行指定主机端口且挂载外部目录，且出错重启" class="headerlink" title="基于image运行docker容器同时运行指定主机端口且挂载外部目录，且出错重启"></a>基于image运行docker容器同时运行指定主机端口且挂载外部目录，且出错重启</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>格式  </span><br><span class="line">-v 参数：  </span><br><span class="line"><span class="meta">#</span>冒号前为宿主机目录，必须为绝对路径，冒号后为镜像内挂载的路径。  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>示例  </span><br><span class="line">docker run --restart=always -itdp 1230:1235 -v /etc/localtime:/etc/localtime:ro liimages/spider2.0 ./run.sh</span><br></pre></td></tr></table></figure>
<h3 id="进入到容器内部可以修改相关配置-不使用attach，attach方式因为退出，导致整个容器退出"><a href="#进入到容器内部可以修改相关配置-不使用attach，attach方式因为退出，导致整个容器退出" class="headerlink" title="进入到容器内部可以修改相关配置,不使用attach，attach方式因为退出，导致整个容器退出"></a>进入到容器内部可以修改相关配置,不使用attach，attach方式因为退出，导致整个容器退出</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>格式  </span><br><span class="line">docker exec -it 容器名称或者容器Id /bin/sh  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>示例  </span><br><span class="line">docker exec -it bb2 /bin/sh</span><br></pre></td></tr></table></figure>
<h3 id="删除镜像-删除容器是rm"><a href="#删除镜像-删除容器是rm" class="headerlink" title="删除镜像.删除容器是rm"></a>删除镜像.删除容器是rm</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>格式  </span><br><span class="line">格式一：docker rmi 镜像名或者镜像Id  </span><br><span class="line">格式二：docker rmi -f 镜像名或者镜像Id  </span><br><span class="line"><span class="meta">#</span>备注：强制删除与该镜像有关的容器（包括启动中的）和该镜像  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>示例  </span><br><span class="line">docker rmi liimages/spider2.0</span><br></pre></td></tr></table></figure>
<h3 id="把打包的镜像上传到仓库"><a href="#把打包的镜像上传到仓库" class="headerlink" title="把打包的镜像上传到仓库"></a>把打包的镜像上传到仓库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>格式  </span><br><span class="line"><span class="meta">#</span>前提1：镜像的名字要符合官方标准  </span><br><span class="line"><span class="meta">#</span>前提2：使用docker login 登录  </span><br><span class="line">格式：docker push 镜像名  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>示例  </span><br><span class="line">docker push 镜像名</span><br></pre></td></tr></table></figure>
<h3 id="服务的启动命令"><a href="#服务的启动命令" class="headerlink" title="服务的启动命令"></a>服务的启动命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>mysql的启动命令  </span><br><span class="line">docker run --restart=always --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=mypassword -d docker.io/mysql   </span><br><span class="line"><span class="meta">#</span>启动一个mysql  </span><br><span class="line"><span class="meta">#</span>其中--restart=always是自动启动的意思  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>redis的启动命令  </span><br><span class="line">docker run --restart=always  -p 6379:6379 --name redis -d redis redis-server --appendonly yes --requirepass mypassword  </span><br><span class="line"><span class="meta">#</span>其中：--appendonly yes是持久化数据的意思  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>安装gitlab  </span><br><span class="line"><span class="meta">#</span>dock查找镜像  </span><br><span class="line">docker search gitlab  </span><br><span class="line"><span class="meta">#</span>下载汉化的社区版本  </span><br><span class="line">docker pull  twang2218/gitlab-ce-zh  </span><br><span class="line"><span class="meta">#</span>下载好之后运行镜像  </span><br><span class="line">docker run -d -p 8888:80 --restart=always --name gitlab twang2218/gitlab-ce-zh</span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/study/">study</a><a href="/tags/docker/">docker</a></div><div class="post-nav"><a class="next" href="/2018/11/05/nsq的使用/">nsq的使用</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yoursite.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/study/">study</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/study/">study</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/study/docker/">docker</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/摇摇晃晃/">摇摇晃晃</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/study/" style="font-size: 15px;">study</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/golang/" style="font-size: 15px;">golang</a> <a href="/tags/摇摇晃晃/" style="font-size: 15px;">摇摇晃晃</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/11/07/docker-笔记/">docker 笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/05/nsq的使用/">nsq的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/04/对于goroutine的一些理解/">对于goroutine的一些理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/03/mac搭建hexo-github博客/">mac搭建hexo+github博客</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/15/那个人藏了多少秘密/">那个人藏了多少秘密</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/20/我爸/">我爸</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">刘洋的博客.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>